"use strict";(self.webpackChunkvirtual_greenhouse_frontend=self.webpackChunkvirtual_greenhouse_frontend||[]).push([[155],{155:(e,s,a)=>{a.r(s),a.d(s,{default:()=>d});var r=a(43),t=a(216),i=a(475),l=a(621),n=a(579);const d=()=>{const[e,s]=(0,r.useState)({items:[],totalAmount:0}),[a,d]=(0,r.useState)(!0),[c,o]=(0,r.useState)(null),[h,m]=(0,r.useState)(!1),[p,u]=(0,r.useState)(null),[x,j]=(0,r.useState)({shippingAddress:"",paymentMethod:"Credit Card"}),y=(0,t.Zp)(),v=(0,r.useCallback)((async()=>{try{d(!0),o(null);const e=await l.H1.getCart();s(e.data);const a=JSON.parse(localStorage.getItem("user")||"{}");a.address&&j((e=>({...e,shippingAddress:a.address})))}catch(e){console.error("Error fetching cart:",e),o("Failed to load your cart. Please try again.")}finally{d(!1)}}),[]);(0,r.useEffect)((()=>{v()}),[v]);const g=(0,r.useCallback)((e=>{const{name:s,value:a}=e.target;j((e=>({...e,[s]:a})))}),[]),N=(0,r.useCallback)((async e=>{if(e.preventDefault(),x.shippingAddress.trim())if(x.paymentMethod)try{d(!0),o(null);const e=await l.rX.createOrder(x);u(e.data._id),m(!0),s({items:[],totalAmount:0})}catch(t){var a,r;console.error("Error placing order:",t),o((null===(a=t.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||"Failed to place order. Please try again.")}finally{d(!1)}else o("Please select a payment method.");else o("Please enter a shipping address.")}),[x]),f=(0,r.useMemo)((()=>0===e.items.length?(0,n.jsx)("p",{className:"empty-cart-message",children:"Your cart is empty"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"summary-items",children:e.items.map((e=>{var s,a,r;return(0,n.jsxs)("div",{className:"summary-item",children:[(0,n.jsx)("div",{className:"item-image",children:(0,n.jsx)("img",{src:(null===(s=e.plant)||void 0===s?void 0:s.imageUrl)||"/assets/plant-placeholder.jpg",alt:null===(a=e.plant)||void 0===a?void 0:a.name,loading:"lazy"})}),(0,n.jsxs)("div",{className:"item-details",children:[(0,n.jsx)("h3",{children:null===(r=e.plant)||void 0===r?void 0:r.name}),(0,n.jsxs)("p",{children:["Quantity: ",e.quantity]}),(0,n.jsxs)("p",{className:"item-price",children:["\u20b9",(e.price*e.quantity).toFixed(2)]})]})]},e._id)}))}),(0,n.jsxs)("div",{className:"price-summary",children:[(0,n.jsxs)("div",{className:"summary-row",children:[(0,n.jsx)("span",{children:"Subtotal"}),(0,n.jsxs)("span",{children:["$",e.totalAmount.toFixed(2)]})]}),(0,n.jsxs)("div",{className:"summary-row",children:[(0,n.jsx)("span",{children:"Shipping"}),(0,n.jsx)("span",{children:"Free"})," "]}),(0,n.jsxs)("div",{className:"summary-row total",children:[(0,n.jsx)("span",{children:"Total"}),(0,n.jsxs)("span",{children:["$",e.totalAmount.toFixed(2)]})]})]})]})),[e.items,e.totalAmount]);return(0,n.jsxs)("div",{className:"checkout-page",children:[(0,n.jsxs)("header",{className:"checkout-header",children:[(0,n.jsx)(i.N_,{to:"/user-dashboard",className:"logo",children:"VirtualGreen"}),(0,n.jsxs)("nav",{className:"checkout-nav",children:[(0,n.jsx)(i.N_,{to:"/user-dashboard",children:"Home"}),(0,n.jsx)(i.N_,{to:"/shops",children:"Shops"}),(0,n.jsx)(i.N_,{to:"/cart",children:"Cart"})]})]}),(0,n.jsxs)("div",{className:"checkout-container",children:[(0,n.jsx)("h1",{children:h?"Order Confirmation":"Checkout"}),a&&!h&&(0,n.jsxs)("div",{className:"loading-spinner",children:[(0,n.jsx)("div",{className:"spinner"}),(0,n.jsx)("p",{children:"Loading checkout..."})]}),c&&!(!x.shippingAddress.trim()||!x.paymentMethod)&&(0,n.jsx)("div",{className:"error-message general",children:c}),!a&&h&&(0,n.jsxs)("div",{className:"order-success",children:[(0,n.jsx)("div",{className:"success-icon",children:"\u2713"}),(0,n.jsx)("h2",{children:"Order Placed Successfully!"}),(0,n.jsx)("p",{children:"Your order has been placed successfully. Thank you for shopping with us!"}),p&&(0,n.jsxs)("p",{className:"order-id",children:["Order ID: ",p]}),(0,n.jsxs)("div",{className:"success-buttons",children:[(0,n.jsx)("button",{onClick:()=>y("/user-dashboard"),className:"home-btn",children:"Return to Home"}),(0,n.jsx)("button",{onClick:()=>y("/orders"),className:"view-orders-btn",children:"View My Orders"})]})]}),!a&&!h&&(0,n.jsxs)("div",{className:"checkout-content",children:[(0,n.jsxs)("div",{className:"checkout-summary",children:[(0,n.jsx)("h2",{children:"Order Summary"}),f]}),(0,n.jsxs)("div",{className:"checkout-form-container",children:[(0,n.jsx)("h2",{children:"Shipping & Payment"}),(0,n.jsxs)("form",{onSubmit:N,className:"checkout-form",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"shippingAddress",children:"Shipping Address"}),(0,n.jsx)("textarea",{id:"shippingAddress",name:"shippingAddress",value:x.shippingAddress,onChange:g,placeholder:"Enter your full shipping address",required:!0,rows:"4"}),c&&""===x.shippingAddress.trim()&&(0,n.jsx)("p",{className:"error-message",children:c})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Payment Method"}),(0,n.jsxs)("div",{className:"payment-methods",children:[(0,n.jsxs)("div",{className:"payment-method",children:[(0,n.jsx)("input",{type:"radio",id:"creditCard",name:"paymentMethod",value:"Credit Card",checked:"Credit Card"===x.paymentMethod,onChange:g}),(0,n.jsx)("label",{htmlFor:"creditCard",children:"Credit Card"})]}),(0,n.jsxs)("div",{className:"payment-method",children:[(0,n.jsx)("input",{type:"radio",id:"paypal",name:"paymentMethod",value:"PayPal",checked:"PayPal"===x.paymentMethod,onChange:g}),(0,n.jsx)("label",{htmlFor:"paypal",children:"PayPal"})]}),(0,n.jsxs)("div",{className:"payment-method",children:[(0,n.jsx)("input",{type:"radio",id:"cod",name:"paymentMethod",value:"Cash On Delivery",checked:"Cash On Delivery"===x.paymentMethod,onChange:g}),(0,n.jsx)("label",{htmlFor:"cod",children:"Cash On Delivery"})]})]}),c&&!x.paymentMethod&&(0,n.jsx)("p",{className:"error-message",children:c})]}),(0,n.jsxs)("div",{className:"checkout-actions",children:[(0,n.jsx)(i.N_,{to:"/cart",className:"back-to-cart",children:"Back to Cart"}),(0,n.jsx)("button",{type:"submit",className:"place-order-btn",disabled:a||0===e.items.length||!x.shippingAddress.trim()||!x.paymentMethod,children:a?"Processing...":"Place Order"})]})]})]})]}),!a&&!h&&0===e.items.length&&(0,n.jsxs)("div",{className:"empty-cart-container",children:[(0,n.jsx)("h2",{children:"Your Cart is Empty"}),(0,n.jsx)("p",{children:"Looks like you haven't added anything to your cart yet."}),(0,n.jsx)(i.N_,{to:"/shops",className:"shop-now-link",children:"Shop Now"})]})]}),(0,n.jsxs)("footer",{className:"checkout-footer",children:[(0,n.jsxs)("div",{className:"footer-content",children:[(0,n.jsxs)("div",{className:"footer-section",children:[(0,n.jsx)("h3",{children:"About Us"}),(0,n.jsx)("p",{children:"VirtualGreen is your online destination for plants."})]}),(0,n.jsxs)("div",{className:"footer-section",children:[(0,n.jsx)("h3",{children:"Contact"}),(0,n.jsx)("p",{children:"Email: info@virtualgreen.com"}),(0,n.jsx)("p",{children:"Phone: (123) 456-7890"})]}),(0,n.jsx)("div",{className:"footer-section",children:(0,n.jsx)("h3",{children:"Follow Us"})})]}),(0,n.jsx)("p",{className:"footer-bottom-text",children:"\xa9 2023 VirtualGreen. All rights reserved."})]})]})}}}]);
//# sourceMappingURL=155.6917bee1.chunk.js.map